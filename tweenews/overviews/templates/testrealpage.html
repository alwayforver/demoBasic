<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="UIUC DM Group">
    <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png">

    <title>Tweenews News Page</title>

    <!-- Bootstrap core CSS -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">

    

<style>

path.link{
    fill: none;
    stroke: #666;
    stroke-width: 1.5px;
}   


path.li/*nk.t1{
    stroke: #ff0000;
}   

path.link.t2{
    stroke: rgb(10,255,255)
    
}*/
circle {
    fill: none;
    stroke: black;
    stroke-width: 1.5px;
}

text {
    font: 10px sans-serif;
    pointer-events: none;
}

text.shadow {
    stroke: #fff;
    stroke-width: 3px;
    stroke-opacity: .8;
}

body {
    background-color: white;
    margin: 0px;
}
.axis path,
    .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
    }
    /*.x.axis path {
        display: none;
    }*/
    .line {
        fill: none;
        stroke: steelblue;
        stroke-width: 1.5px;
    }

.graphContainer {
    margin-left: -100px;
    text-shadow: -1px -1px 0 white, 1px -1px 0 white, -1px 1px 0 white, 1px 1px 0 white;
    float: left;
    margin-top: -60px;

}
.networkGraph{
  float: left;
}
.distGraph{
  margin-left: 600px;
  margin-top: 80px;
  /*float: left;*/

}
#summary{
    margin-top:70px;
}

</style>





    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../docs-assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
 
    

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
     

    
    
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Tweenews: Twitter with News</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/overviews/">Home</a></li>
            <li><a href="/overviews/news/">News Overview</a></li>
            <li><a href="/overviews/event_discovery/">Event Discovery</a></li>
            <!-- <li><a href="https://code.jquery.com/jquery-1.10.2.min.js">News with Tweet</a></li> -->
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    

    <div class="container theme-showcase">
    
      <div class="top-buffer">
        <!-- Make the space for top -->
      </div>

      <a name="top"></a>
      <div class="col-xs-12 search-box">
        

    </div>
    

      <h2>Event Details Page</h2>

    
    <h3> Entity Graph(left) and Time Distribution (right) </h3>


<div class='row'>
    <div class="col-xs-6" id="area1"></div>
    <div class="col-xs-6" id="area2">area2</div>
    <!-- <div class="col-xs-6" id="area3">area3</div> -->

</div>

<div class='row'>
    <div class="col-xs-6" id="area4">area4</div>
    <div class="col-xs-6" id="area5">area5</div>
    <div class="col-xs-6" id="area6">area6</div>

</div>

<script>
$(function(){var data = {
        "nodes":  [
{"id": 0, "name": "John_Kerry:person", size:"5.67372796446",color:"red", text: "person"},
{"id": 1, "name": "The_Pentagon:place", size:"4.31450698962",color:"green", text: "place"},
{"id": 2, "name": "Sony:org", size:"8.56876395143",color:"yellow", text: "org"},
{"id": 3, "name": "CNN:org", size:"5.39090955703",color:"yellow", text: "org"},
{"id": 4, "name": "China:place", size:"6.79628446252",color:"green", text: "place"},
],
"links": [
{"source": 0, "target": 3, color:"#008080", weight:1.90334745384, text: "aspect1" },
{"source": 2, "target": 4, color:"#333333", weight:0.804480662506, text: "aspect2" },
{"source": 2, "target": 1, color:"#800000", weight:0.519490245476,text: "aspect3" },
],

"legendC":[
{color: "blue"},
{color: "red"},]
};   // used to store the number of links between two nodes. 
    // mLinkNum[data.links[i].source + "," + data.links[i].target] = data.links[i].linkindex;
    var mLinkNum = {};
    
    // sort links first
    sortLinks();                                
    
    // set up linkIndex and linkNumer, because it may possible multiple links share the same source and target node
    setLinkIndexAndNum();
    
    var w = 550,
        h = 500;
    
    var force = d3.layout.force()
                  .nodes(d3.values(data.nodes))
                  .links(data.links)
                  .size([w, h])
                  .linkDistance(150)
                  .charge(-300)
                  .on("tick", tick)
                  .start();
    
    var svg = d3.select("#area1").append("svg:svg")
                .attr("width", w)
                .attr("height", h);
var color = d3.scale.category10();

var ageNames = data.nodes[text];
console.log(ageNames);

var legend = svg.selectAll(".legend")
      .data(color.domain())
    .enter().append("g")
      .attr("class", "legend")
      .attr("transform", 'translate(' + (width / 2) +  ',' + (height / 2) + ')');

  legend.append("rect")
      .attr("x", width - 18)
      .attr("width", 18)
      .attr("height", 18)
      .style("fill", color);

  legend.append("text")
      .attr("x", width - 24)
      .attr("y", 9)
      .attr("dy", ".35em")
      .style("text-anchor", "end")
      .text(function(d) { return "try"; });
    
var path = svg.append("svg:g").selectAll("path")
    .data(force.links())
  .enter().append("svg:path")
  .style("stroke", function(d){return d.color})
  .style("stroke-width", function(d){return d.weight+"px"})
  .style("opacity", 0.5);
  
  
    // .attr("class", function(d) { return "link " + d.type; })
   ;
    
    var circle = svg.append("svg:g")
                    .selectAll("circle")
                    .data(force.nodes())
                    .enter().append("svg:circle")
                    // .attr("r", 6)
                    .attr("r", function(d){return d.size; })
                    // .attr("class",function(d) { console.log("node " + d.type); return "node " + d.type; })
                    .call(force.drag)
                    .style("fill", function(d){ return d.color;});
  
    var text = svg.append("svg:g")                                
                  .selectAll("g")
                  .data(force.nodes())
                  .enter().append("svg:g");
    
    // A copy of the text with a thick white stroke for legibility.
    text.append("svg:text")
        .attr("x", 8)
        .attr("y", ".31em")
        .attr("class", "shadow")
        .text(function(d) { return d.name; });  
    
    text.append("svg:text")
        .attr("x", 8)
        .attr("y", ".31em")
        .text(function(d) { return d.name; });
    
    // Use elliptical arc path segments to doubly-encode directionality.
    function tick() {
        path.attr("d", function(d) {
            var dx = d.target.x - d.source.x,
                dy = d.target.y - d.source.y,
                dr = Math.sqrt(dx * dx + dy * dy);
            // get the total link numbers between source and target node
            var lTotalLinkNum = mLinkNum[d.source.id + "," + d.target.id] || mLinkNum[d.target.id + "," + d.source.id];
            if(lTotalLinkNum > 1)
            {
                // if there are multiple links between these two nodes, we need generate different dr for each path
                dr = dr/(1 + (1/lTotalLinkNum) * (d.linkindex - 1));
            }       
            // generate svg path
            return "M" + d.source.x + "," + d.source.y + 
                "A" + dr + "," + dr + " 0 0 1," + d.target.x + "," + d.target.y + 
                "A" + dr + "," + dr + " 0 0 0," + d.source.x + "," + d.source.y;    
        });
        
        // Add tooltip to the connection path
        path.append("svg:title")
            .text(function(d, i) { return d.name; });
        
        circle.attr("transform", function(d) {
            return "translate(" + d.x + "," + d.y + ")";
        });
        
        text.attr("transform", function(d) {
            return "translate(" + d.x + "," + d.y + ")";
        });
    } 
    
    // sort the links by source, then target
    function sortLinks()
    {                               
        data.links.sort(function(a,b) {
            if (a.source > b.source) 
            {
                return 1;
            }
            else if (a.source < b.source) 
            {
                return -1;
            }
            else 
            {
                if (a.target > b.target) 
                {
                    return 1;
                }
                if (a.target < b.target) 
                {
                    return -1;
                }
                else 
                {
                    return 0;
                }
            }
        });
    }
    
    //any links with duplicate source and target get an incremented 'linknum'
    function setLinkIndexAndNum()
    {                               
        for (var i = 0; i < data.links.length; i++) 
        {
            if (i != 0 &&
                data.links[i].source == data.links[i-1].source &&
                data.links[i].target == data.links[i-1].target) 
            {
                data.links[i].linkindex = data.links[i-1].linkindex + 1;
            }
            else 
            {
                data.links[i].linkindex = 1;
            }
            // save the total number of links between two nodes
            if(mLinkNum[data.links[i].target + "," + data.links[i].source] !== undefined)
            {
                mLinkNum[data.links[i].target + "," + data.links[i].source] = data.links[i].linkindex;
            }
            else
            {
                mLinkNum[data.links[i].source + "," + data.links[i].target] = data.links[i].linkindex;
            }
        }
    }   
});         
</script>



     

            
<script type="text/javascript">
//setting up empty data array
var data = [];

getData(); // popuate data 

// console.log(data);

// console.log(d[1][0])
// line chart based on http://bl.ocks.org/mbostock/3883245
var margin = {
        top: 20,
        right: 20,
        bottom: 30,
        left: 50
    },
    width = 500 - margin.left - margin.right,
    height = 300 - margin.top - margin.bottom;

var x = d3.scale.linear()
    .range([0, width]);

var y = d3.scale.linear()
    .range([height, 0]),
    yMap = function(d){
        return null
    }

var format = d3.time.format("%d/%m/%Y");
var dateMin = format.parse("18/12/2014");
var dateMax = format.parse("05/01/2015");

var xValue = function (v) {
    var myDate = new Date( v.x *1000);
    return myDate.toGMTString()
},
xScale = d3.time.scale().domain([dateMin, dateMax]).range([0, width]), // value -> display
    xMap = function (d) {
        console.log(xScale.domain()[1].toISOString());
        console.log(d)
        return xScale(xValue(d));
    }, // data -> display
    xAxis = d3.svg.axis()
    .scale(xScale)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left")
    .ticks(5);

var line1 = d3.svg.line()
    .x(function(d) {
        return x(d.q);
    })
    .y(function(d) {
        return y(d.l1);
    });

var line2 = d3.svg.line()
    .x(function(d) {
        return x(d.q);
    })
    .y(function(d) {
        return y(d.l2);
    });

var line3 = d3.svg.line()
    .x(function(d) {
        return x(d.q);
    })
    .y(function(d) {
        return y(d.l3);
    });

var line4 = d3.svg.line()
    .x(function(d) {
        return x(d.q);
    })
    .y(function(d) {
        return y(d.l4);
    });

var line5 = d3.svg.line()
    .x(function(d) {
        return x(d.q);
    })
    .y(function(d) {
        return y(d.l5);
    });

var line6 = d3.svg.line()
    .x(function(d) {
        return x(d.q);
    })
    .y(function(d) {
        return y(d.l6);
    });
// var line

var svg = d3.select("#area2").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

x.domain(d3.extent(data, function(d) {
    return d.q;
}));
y.domain(d3.extent(data, function(d) {
    return d.l2;
}));



svg.append("g")
    .attr("class", "x axis")
    // .attr("transform", "translate(0," + height + ")")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

svg.append("g")
    .attr("class", "y axis")
    // .attr("transform", "translate(0," + height + ")")
    .call(yAxis);

svg.append("path")
    .datum(data)
    .attr("class", "line")
    .attr("d", line1)
    .style("stroke","#ff0000");

svg.append("path")
    .datum(data)
    .attr("class", "line")
    .attr("d", line2)
    .style("stroke","#008080");

svg.append("path")
    .datum(data)
    .attr("class", "line")
    .attr("d", line3)
    .style("stroke","#0000ff");

svg.append("path")
    .datum(data)
    .attr("class", "line")
    .attr("d", line4)
    .style("stroke","#660066");

svg.append("path")
    .datum(data)
    .attr("class", "line")
    .attr("d", line5)
    .style("stroke","#333333");

svg.append("path")
    .datum(data)
    .attr("class", "line")
    .attr("d", line6)
    .style("stroke","#800000");

function getData() {

// loop to populate data array with 
// probabily - quantile pairs
    // for(var j = 0; j<1; j++){
    //     var current = []
    //     for (var i = 0; i < 100000; i++) {
            
    //         q = normal(1419305576, 39603.2746308182) // calc random draw from normal dist
    //         p = gaussian(q, 1419305576, 39603.2746308182) // calc prob of rand draw
    //         el = {
    //             "q": q,
    //             "p": p
    //         }
    //         current.push(el)
    //     };

    //     // need to sort for plotting
    //     //https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort
    //     current.sort(function(x, y) {
    //         return x.q - y.q;
    //     }); 
    //     data.push(current)
    // }

        // q = 1418860800

        for (var i = 0; i < 17000; i++) {
            
            q  = 1418860800+i*100 // calc random draw from normal dist
            // q = normal(1419305576, 39603.2746308182)
            l1 = gaussian(q, 1420295189.00000, 68241.4180316839)
            l2 = gaussian(q, 1419305576, 39603.2746308182) // calc prob of rand draw
            l3 = gaussian(q, 1419661303.00000, 119394.950349547) // calc prob of rand draw
            l4 = gaussian(q, 1419321628.00000, 226285.833173850) // calc prob of rand draw
            l5 = gaussian(q, 1420096069.00000, 49752.7380936543) // calc prob of rand draw
            l6 = gaussian(q, 1419690295.00000, 43098.0539786714) // calc prob of rand draw
            el = {
                "q": q,
                "l1": l1,
                "l2": l2,
                "l3": l3,
                "l4": l4,
                "l5": l5,
                "l6": l6,

            }
            data.push(el)
        };

        // need to sort for plotting
        //https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort
        data.sort(function(x, y) {
            return x.q - y.q;
        }); 


}

// from http://bl.ocks.org/mbostock/4349187
// Sample from a normal distribution with mean 0, stddev 1.
function normal(mean, sigma) {
    var x = 0,
        y = 0,
        rds, c;
    do {
        x = Math.random() * 2 - 1;
        y = Math.random() * 2 - 1;
        rds = x * x + y * y;
    } while (rds == 0 || rds > 1);
    c = Math.sqrt(-2 * Math.log(rds) / rds); // Box-Muller transform
    return x * c * sigma+mean; // throw away extra sample y * c
}

//taken from Jason Davies science library
// https://github.com/jasondavies/science.js/
function gaussian(x, mean, sigma) {
    var gaussianConstant = 1 / Math.sqrt(2 * Math.PI),
        // mean =  1419305576,
        // sigma = 39603.2746308182;

    x = (x - mean) / sigma;
    return gaussianConstant * Math.exp(-.5 * x * x) / sigma;
};
</script>


        




   



    
      
  </body>
  </html>